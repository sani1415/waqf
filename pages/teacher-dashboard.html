<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Teacher Dashboard - Task Manager</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/teacher.css">
    <link rel="stylesheet" href="../css/daily-overview.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="teacher-dashboard">
    <script src="../js/i18n.js"></script>
    <script src="../js/hijri-date.js"></script>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-graduation-cap"></i>
            <h2 data-i18n="task_manager">Task Manager</h2>
        </div>
        
        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-section="dashboard">
                <i class="fas fa-home"></i>
                <span data-i18n="nav_dashboard">Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-section="manage-tasks">
                <i class="fas fa-tasks"></i>
                <span data-i18n="nav_manage_tasks">Manage Tasks</span>
            </a>
            <a href="#" class="nav-item" data-section="students">
                <i class="fas fa-users"></i>
                <span data-i18n="nav_students">Students</span>
            </a>
            <a href="#" class="nav-item" data-section="daily-overview">
                <i class="fas fa-table"></i>
                <span data-i18n="nav_daily_overview">Daily Tasks Overview</span>
            </a>
            <a href="/pages/teacher-exams.html" class="nav-item">
                <i class="fas fa-graduation-cap"></i>
                <span data-i18n="nav_exams">Exams</span>
            </a>
            <a href="/pages/teacher-messages.html" class="nav-item">
                <i class="fas fa-comments"></i>
                <span data-i18n="nav_messages">Messages</span>
                <span id="totalUnreadBadge" class="nav-badge" style="display: none;">0</span>
            </a>
            <a href="#" class="nav-item" data-section="documents-for-review">
                <i class="fas fa-file-upload"></i>
                <span data-i18n="documents_for_review">Documents for Review</span>
            </a>
            <a href="#" class="nav-item" data-section="analytics">
                <i class="fas fa-chart-bar"></i>
                <span data-i18n="nav_analytics">Analytics</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="lang-switcher lang-switcher-sidebar" aria-label="Language">
                <button type="button" class="lang-btn" data-lang="en" onclick="setLang('en')" title="English">EN</button>
                <button type="button" class="lang-btn" data-lang="bn" onclick="setLang('bn')" title="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ">‡¶¨‡¶æ‡¶Ç</button>
            </div>
            <a href="/index.html" class="nav-item" onclick="if(typeof logoutTeacher==='function')logoutTeacher();">
                <i class="fas fa-sign-out-alt"></i>
                <span data-i18n="logout">Logout</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header class="top-bar">
            <button class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </button>
            <h1 class="page-title" id="pageTitle" data-i18n="nav_dashboard">Dashboard</h1>
            <div class="top-bar-right">
                <div class="lang-switcher lang-switcher-compact lang-switcher-header" aria-label="Language">
                    <button type="button" class="lang-btn" data-lang="en" onclick="setLang('en')" title="English">EN</button>
                    <button type="button" class="lang-btn" data-lang="bn" onclick="setLang('bn')" title="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ">‡¶¨‡¶æ‡¶Ç</button>
                </div>
                <div class="date-format-toggle"></div>
                <div class="user-info user-info-desktop">
                    <i class="fas fa-user-circle"></i>
                    <span data-i18n="teacher">Teacher</span>
                </div>
                <a href="/index.html" class="btn-secondary btn-logout-header" onclick="if(typeof logoutTeacher==='function')logoutTeacher();">
                    <i class="fas fa-sign-out-alt"></i> <span data-i18n="logout">Logout</span>
                </a>
            </div>
        </header>

        <!-- Dashboard Section -->
        <section id="dashboard-section" class="content-section active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: #e3f2fd;">
                        <i class="fas fa-users" style="color: #2196F3;"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalStudents">0</h3>
                        <p><span class="stat-label-desktop" data-i18n="stat_total_students">Total Students</span><span class="stat-label-mobile" data-i18n="stat_students">Students</span></p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: #f3e5f5;">
                        <i class="fas fa-tasks" style="color: #9C27B0;"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalTasks">0</h3>
                        <p><span class="stat-label-desktop" data-i18n="stat_total_tasks">Total Tasks</span><span class="stat-label-mobile" data-i18n="stat_tasks">Tasks</span></p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: #e8f5e9;">
                        <i class="fas fa-check-circle" style="color: #4CAF50;"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="completedTasks">0</h3>
                        <p><span class="stat-label-desktop" data-i18n="stat_completed_tasks">Completed Tasks</span><span class="stat-label-mobile" data-i18n="stat_done">Done</span></p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: #fff3e0;">
                        <i class="fas fa-clock" style="color: #FF9800;"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="pendingTasks">0</h3>
                        <p><span class="stat-label-desktop" data-i18n="stat_pending_tasks">Pending Tasks</span><span class="stat-label-mobile" data-i18n="stat_pending">Pending</span></p>
                    </div>
                </div>
            </div>

            <div class="dashboard-content">
                <div class="students-progress">
                    <div class="progress-section-header">
                        <h2 class="section-title" data-i18n="section_students_progress">Students Progress</h2>
                        <div class="progress-tabs">
                            <button type="button" class="progress-tab daily active" data-progress-view="daily"><i class="fas fa-redo-alt"></i> <span data-i18n="tab_daily">Daily</span></button>
                            <button type="button" class="progress-tab onetime" data-progress-view="onetime"><i class="fas fa-clipboard-list"></i> <span data-i18n="tab_onetime">One-time</span></button>
                            <button type="button" class="progress-tab spreadsheet" data-progress-view="spreadsheet"><i class="fas fa-table"></i> <span data-i18n="tab_spreadsheet">Spreadsheet</span></button>
                        </div>
                    </div>
                    <div id="view-daily" class="progress-view active">
                        <div id="studentsProgressListDaily" class="progress-list progress-summary-list"></div>
                    </div>
                    <div id="view-onetime" class="progress-view">
                        <div id="studentsProgressListOnetime" class="progress-list progress-summary-list"></div>
                    </div>
                    <div id="view-spreadsheet" class="progress-view">
                        <div id="spreadsheetTaskFilter" class="spreadsheet-task-filter" style="display: none;">
                            <span class="spreadsheet-filter-label" data-i18n="show_tasks">Show:</span>
                            <button type="button" class="spreadsheet-filter-btn active" data-filter="all"><span data-i18n="spreadsheet_filter_all">All</span></button>
                            <button type="button" class="spreadsheet-filter-btn" data-filter="daily"><span data-i18n="tab_daily">Daily</span></button>
                            <button type="button" class="spreadsheet-filter-btn" data-filter="onetime"><span data-i18n="tab_onetime">One-time</span></button>
                        </div>
                        <div id="studentsProgressSpreadsheet" class="spreadsheet-wrap"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Manage Tasks Section -->
        <section id="manage-tasks-section" class="content-section">
            <!-- Tab Navigation for Manage Tasks -->
            <div class="manage-tasks-tabs">
                <button class="manage-tab-btn active" onclick="switchManageTaskTab('create')">
                    <i class="fas fa-plus-circle"></i> <span data-i18n="tab_create_task">Create Task</span>
                </button>
                <button class="manage-tab-btn" onclick="switchManageTaskTab('view')">
                    <i class="fas fa-list"></i> <span data-i18n="tab_view_tasks">View All Tasks</span>
                </button>
            </div>

            <!-- Create Task Tab -->
            <div id="createTaskTab" class="manage-tab-content active">
            <div class="form-container">
                    <h2><i class="fas fa-plus-circle"></i> <span data-i18n="create_new_task">Create New Task</span></h2>
                <form id="createTaskForm">
                    <div class="form-group">
                        <label for="taskTitle" data-i18n="task_title">Task Title</label>
                        <input type="text" id="taskTitle" required data-i18n-placeholder="placeholder_task_title" placeholder="Enter task title">
                    </div>

                    <div class="form-group">
                        <label for="taskDescription" data-i18n="task_description">Description</label>
                        <textarea id="taskDescription" rows="4" data-i18n-placeholder="placeholder_task_description" placeholder="Enter task description"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="taskType" data-i18n="task_type">Task Type</label>
                        <select id="taskType" required onchange="handleTaskTypeChange()">
                            <option value="one-time" data-i18n="task_type_onetime">One-time Task</option>
                            <option value="daily" data-i18n="task_type_daily">Daily Routine</option>
                        </select>
                        <small class="form-hint" id="taskTypeHint" style="display: none; color: #666; margin-top: 0.5rem;" data-i18n="task_type_hint">
                            Daily routines repeat every day and don't have deadlines
                        </small>
                    </div>

                    <div class="form-group" id="studentSelectionGroup">
                        <label data-i18n="assign_to">Assign To</label>
                        <div style="margin-bottom: 1rem;">
                            <label class="checkbox-item" style="background: #e3f2fd; padding: 0.75rem; border-radius: 8px;">
                                <input type="checkbox" id="assignToAll" onchange="handleAssignToAllChange()">
                                <span style="font-weight: 600; color: #1976D2;" data-i18n="assign_to_all">Assign to All Students</span>
                            </label>
                        </div>
                        <div id="studentCheckboxes" class="checkbox-group">
                            <!-- Checkboxes will be dynamically added here -->
                        </div>
                    </div>

                    <div class="form-group" id="deadlineGroup">
                        <label for="taskDeadline" data-i18n="deadline">Deadline</label>
                        <input type="date" id="taskDeadline">
                    </div>

                    <button type="submit" class="btn-primary">
                        <i class="fas fa-plus"></i> <span data-i18n="btn_create_task">Create Task</span>
                    </button>
                </form>
                </div>
            </div>

            <!-- View All Tasks Tab -->
            <div id="viewTasksTab" class="manage-tab-content">
                <div class="tasks-list-container">
                <div class="section-header">
                    <h2><i class="fas fa-list"></i> <span data-i18n="all_tasks">All Tasks</span> <span class="task-count-badge" id="taskCountBadge">0</span></h2>
                    <div class="task-filters">
                        <button class="filter-btn active" onclick="filterTasks('all')" data-i18n="filter_all">All</button>
                        <button class="filter-btn" onclick="filterTasks('one-time')" data-i18n="filter_onetime">One-time</button>
                        <button class="filter-btn" onclick="filterTasks('daily')" data-i18n="filter_daily">Daily</button>
                    </div>
                </div>
                
                <!-- One-time Tasks -->
                <div class="task-category" id="oneTimeTasksCategory">
                    <h3 class="category-title"><i class="fas fa-clipboard-list"></i> <span data-i18n="category_onetime">One-time Tasks</span> <span class="category-count" id="oneTimeTaskCount">0</span></h3>
                    <div id="oneTimeTasksList" class="tasks-list-compact">
                        <!-- One-time tasks will be loaded here -->
                    </div>
                </div>

                <!-- Daily Tasks -->
                <div class="task-category" id="dailyTasksCategory">
                    <h3 class="category-title"><i class="fas fa-redo-alt"></i> <span data-i18n="category_daily">Daily Routines</span> <span class="category-count" id="dailyTaskCount">0</span></h3>
                    <div id="dailyTasksList" class="tasks-list-compact">
                        <!-- Daily tasks will be loaded here -->
                    </div>
                </div>

                <!-- Empty State -->
                <div id="noTasksMessage" class="no-tasks-message" style="display: none;">
                    <i class="fas fa-inbox"></i>
                    <h3 data-i18n="no_tasks_yet">No Tasks Yet</h3>
                    <p data-i18n="no_tasks_hint">Create your first task using the Create Task tab!</p>
                </div>
                </div>
            </div>
        </section>

        <!-- Students Section -->
        <section id="students-section" class="content-section">
            <div class="section-header">
                <h2><span data-i18n="manage_students">Manage Students</span> <span class="student-count-badge" id="studentCountBadge">0</span></h2>
                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                    <button class="btn-primary" onclick="showAddStudentModal()">
                        <i class="fas fa-user-plus"></i> <span data-i18n="add_student">Add Student</span>
                    </button>
                    <button class="btn-secondary" onclick="document.getElementById('importStudentsFile').click()">
                        <i class="fas fa-file-upload"></i> <span data-i18n="import_students">Import from CSV</span>
                    </button>
                    <input type="file" id="importStudentsFile" accept=".csv,.txt" style="display:none" onchange="handleImportStudentsFile(event)">
                </div>
            </div>
            <div id="studentsList" class="students-grid">
                <div class="loading-spinner" style="grid-column: 1 / -1;"><i class="fas fa-circle-notch fa-spin"></i><span data-i18n="loading">Loading...</span></div>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics-section" class="content-section">
            <h2 data-i18n="analytics_overview">Analytics Overview</h2>
            <div id="analyticsLoader" class="loading-spinner" style="display:none;margin:2rem 0;"><i class="fas fa-circle-notch fa-spin"></i><span data-i18n="loading">Loading...</span></div>
            <div id="analyticsContent" class="analytics-grid">
                <div class="analytics-card">
                    <h3 data-i18n="overall_completion_rate">Overall Completion Rate</h3>
                    <div class="progress-circle">
                        <span id="overallCompletion">0%</span>
                    </div>
                </div>
                <div class="analytics-card">
                    <h3 data-i18n="task_distribution">Task Distribution</h3>
                    <div id="taskDistribution">
                        <div class="distribution-item">
                            <span data-i18n="onetime_tasks_label">One-time Tasks:</span>
                            <strong id="oneTimeCount">0</strong>
                        </div>
                        <div class="distribution-item">
                            <span data-i18n="daily_routines_label">Daily Routines:</span>
                            <strong id="dailyCount">0</strong>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Documents for Review Section -->
        <section id="documents-for-review-section" class="content-section">
            <div class="documents-review-container">
                <div class="documents-review-header">
                    <h2><i class="fas fa-file-upload"></i> <span data-i18n="documents_for_review">Documents for Review</span></h2>
                    <p class="documents-review-hint" data-i18n="documents_for_review_hint">Documents that students have marked for you to view. All in one place.</p>
                    <div id="documentsViewToggle" class="documents-view-toggle" style="display: none;">
                        <button type="button" class="view-toggle-btn active" data-view="grouped" title="Group by student">
                            <i class="fas fa-users"></i> <span data-i18n="view_grouped">Grouped by Student</span>
                        </button>
                        <button type="button" class="view-toggle-btn" data-view="table" title="Table view">
                            <i class="fas fa-table"></i> <span data-i18n="view_table">Table View</span>
                        </button>
                    </div>
                </div>
                <div id="documentsForReviewList" class="documents-review-list">
                    <div class="loading-spinner"><i class="fas fa-circle-notch fa-spin"></i><span data-i18n="loading">Loading...</span></div>
                </div>
                <div id="documentsForReviewEmpty" class="documents-review-empty" style="display: none;">
                    <i class="fas fa-folder-open"></i>
                    <h3 data-i18n="no_documents_for_review">No Documents for Review</h3>
                    <p data-i18n="no_documents_for_review_hint">Students can upload documents and mark them for you to view. They will appear here.</p>
                </div>
            </div>
        </section>

        <!-- Daily Overview Section -->
        <section id="daily-overview-section" class="content-section">
            <div class="overview-container-inline">
                <!-- Date Selector Section -->
                <div class="date-selector-section">
                    <div class="date-selector-header">
                        <h3><i class="fas fa-calendar-alt"></i> <span data-i18n="select_date">Select Date</span></h3>
                    </div>
                    <div class="date-selector-controls">
                        <button class="date-btn active" id="todayBtn" onclick="selectTodayOverview()">
                            <i class="fas fa-calendar-day"></i> <span data-i18n="today">Today</span>
                        </button>
                        <button class="date-btn" id="yesterdayBtn" onclick="selectYesterdayOverview()">
                            <i class="fas fa-history"></i> <span data-i18n="yesterday">Yesterday</span>
                        </button>
                        <input type="date" id="customDate" class="date-picker" onchange="selectCustomDateOverview()">
                        <span class="selected-date-display" id="selectedDateDisplay" data-i18n="today">Today</span>
                    </div>
                </div>

                <!-- Best Performing Students Section -->
                <div class="best-students-section">
                    <div class="best-students-header">
                        <h3><i class="fas fa-trophy"></i> <span data-i18n="best_performing_students">Best Performing Students</span></h3>
                    </div>
                    <div class="best-students-grid" id="bestStudentsGrid">
                        <div class="loading-spinner" style="grid-column: 1 / -1;"><i class="fas fa-circle-notch fa-spin"></i><span data-i18n="loading">Loading...</span></div>
                    </div>
                </div>

                <!-- Main Overview Table Section -->
                <div class="overview-table-section">
                    <div class="table-header">
                        <h3><i class="fas fa-clipboard-check"></i> <span data-i18n="completion_status">Completion Status</span></h3>
                        <div class="table-stats">
                            <span class="stat-item">
                                <i class="fas fa-users"></i> 
                                <strong id="totalStudentsOverview">0</strong> <span data-i18n="students_label">Students</span>
                            </span>
                            <span class="stat-item">
                                <i class="fas fa-tasks"></i> 
                                <strong id="totalTasksOverview">0</strong> <span data-i18n="daily_tasks_label">Daily Tasks</span>
                            </span>
                            <span class="stat-item">
                                <i class="fas fa-percentage"></i> 
                                <strong id="overallCompletionOverview">0%</strong> <span data-i18n="overall_completion">Overall Completion</span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="table-container scroll-x">
                        <table class="overview-table" id="overviewTable">
                            <thead>
                                <tr>
                                    <th class="sticky-col student-col">
                                        <i class="fas fa-user"></i> <span data-i18n="student">Student</span>
                                    </th>
                                    <th class="sticky-col info-col">
                                        <i class="fas fa-info-circle"></i> <span data-i18n="info">Info</span>
                                    </th>
                                    <!-- Task columns will be added dynamically -->
                                    <th class="sticky-col completion-col">
                                        <i class="fas fa-chart-pie"></i> <span data-i18n="pct_done">% Done</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="overviewTableBody">
                                <tr><td colspan="20" style="text-align:center;padding:2rem;"><div class="loading-spinner"><i class="fas fa-circle-notch fa-spin"></i><span data-i18n="loading">Loading...</span></div></td></tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Legend -->
                    <div class="table-legend">
                        <span class="legend-item">
                            <span class="legend-icon completed">‚úÖ</span> <span data-i18n="legend_completed">Completed</span>
                        </span>
                        <span class="legend-item">
                            <span class="legend-icon pending">‚ùå</span> <span data-i18n="legend_pending">Pending</span>
                        </span>
                        <span class="legend-item">
                            <span class="legend-icon top-performer">üèÜ</span> <span data-i18n="legend_top_performer">Top Performer (‚â•80%)</span>
                        </span>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
    (function(){
        var h=(window.location.hash||'').replace(/^#/,'').trim();
        var map={'analytics':'analytics','students':'students','manage-tasks':'manage-tasks','daily-overview':'daily-overview','documents-for-review':'documents-for-review'};
        var s=map[h];
        if(s){
            var d=document.getElementById('dashboard-section');
            var t=document.getElementById(s+'-section');
            if(d)d.classList.remove('active');
            if(t)t.classList.add('active');
            var n=document.querySelector('.nav-item[data-section="'+s+'"]');
            if(n){ document.querySelectorAll('.nav-item[data-section]').forEach(function(x){x.classList.remove('active');}); n.classList.add('active'); }
            var b=document.querySelector('.bottom-nav-item[data-section="'+s+'"]');
            if(b){ document.querySelectorAll('.bottom-nav-item[data-section]').forEach(function(x){x.classList.remove('active');}); b.classList.add('active'); }
        }
    })();
    </script>

    <!-- Mobile Bottom Navigation (scrollable, visible on screens ‚â§768px) -->
    <div class="bottom-nav-wrapper">
        <div class="bottom-nav-fade bottom-nav-fade-left" id="bottomNavFadeLeft" aria-hidden="true"><i class="fas fa-chevron-left"></i></div>
        <nav class="bottom-nav" id="bottomNav" aria-label="Main navigation">
            <a href="#" class="bottom-nav-item active" data-section="dashboard" title="Dashboard">
                <i class="fas fa-home"></i>
                <span data-i18n="nav_dashboard">Dashboard</span>
            </a>
            <a href="#" class="bottom-nav-item" data-section="manage-tasks" title="Tasks">
                <i class="fas fa-tasks"></i>
                <span data-i18n="stat_tasks">Tasks</span>
            </a>
            <a href="#" class="bottom-nav-item" data-section="students" title="Students">
                <i class="fas fa-users"></i>
                <span data-i18n="nav_students">Students</span>
            </a>
            <a href="/pages/teacher-messages.html" class="bottom-nav-item bottom-nav-item-msg" title="Messages">
                <i class="fas fa-comments"></i>
                <span data-i18n="nav_messages">Messages</span>
                <span id="messagesUnreadBadgeNav" class="bottom-nav-badge" style="display: none;" aria-label="Unread messages">0</span>
            </a>
            <a href="#" class="bottom-nav-item" data-section="documents-for-review" title="Documents for Review">
                <i class="fas fa-file-upload"></i>
                <span data-i18n="nav_documents">Documents</span>
            </a>
            <a href="/pages/teacher-daily-overview.html" class="bottom-nav-item" title="Daily Overview">
                <i class="fas fa-table"></i>
                <span data-i18n="nav_overview">Overview</span>
            </a>
            <a href="/pages/teacher-exams.html" class="bottom-nav-item" title="Exams">
                <i class="fas fa-graduation-cap"></i>
                <span data-i18n="nav_exams">Exams</span>
            </a>
            <a href="#" class="bottom-nav-item bottom-nav-menu" id="bottomNavMenu" title="More">
                <i class="fas fa-ellipsis-v"></i>
                <span data-i18n="nav_menu">Menu</span>
            </a>
        </nav>
        <div class="bottom-nav-fade bottom-nav-fade-right" id="bottomNavFadeRight" aria-hidden="true"><i class="fas fa-chevron-right"></i></div>
    </div>

    <!-- Add Student Modal - Enhanced Comprehensive Form -->
    <div id="addStudentModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeAddStudentModal()">&times;</span>
            <h2><i class="fas fa-user-plus"></i> <span data-i18n="add_new_student">Add New Student</span></h2>
            <form id="addStudentForm" class="comprehensive-form">
                
                <!-- Section 1: Basic Information -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-id-card"></i> <span data-i18n="basic_information">Basic Information</span></h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="studentName"><span data-i18n="student_name">Student Name</span> <span class="required" data-i18n="required">*</span></label>
                            <input type="text" id="studentName" required data-i18n-placeholder="placeholder_full_name" placeholder="Full Name">
                        </div>
                        <div class="form-group">
                            <label for="studentId"><span data-i18n="student_id">Student ID</span> <span class="required" data-i18n="required">*</span></label>
                            <input type="text" id="studentId" required readonly data-i18n-placeholder="placeholder_student_id" placeholder="waqf-001" title="Auto-generated">
                        </div>
                        <div class="form-group">
                            <label for="studentPin"><span data-i18n="pin">PIN</span> <span class="required" data-i18n="required">*</span></label>
                            <input type="password" id="studentPin" required maxlength="8" data-i18n-placeholder="placeholder_pin" placeholder="4-6 digit PIN" autocomplete="new-password">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="dateOfBirth"><span data-i18n="date_of_birth">Date of Birth</span> <span class="required" data-i18n="required">*</span></label>
                            <input type="date" id="dateOfBirth" required>
                        </div>
                        <div class="form-group">
                            <label for="enrollmentDate"><span data-i18n="admission_date">Admission Date</span> <span class="required" data-i18n="required">*</span></label>
                            <input type="date" id="enrollmentDate" required>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Contact Information -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-address-book"></i> <span data-i18n="contact_information">Contact Information</span></h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="studentPhone" data-i18n="student_phone">Student Phone</label>
                            <input type="tel" id="studentPhone" placeholder="+1234567890">
                        </div>
                        <div class="form-group">
                            <label for="studentEmail" data-i18n="student_email">Student Email</label>
                            <input type="email" id="studentEmail" placeholder="student@example.com">
                        </div>
                    </div>
                </div>

                <!-- Section 3: Parent/Guardian Information -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-users"></i> <span data-i18n="parent_guardian_info">Parent/Guardian Information</span></h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="parentName"><span data-i18n="parent_name">Parent/Guardian Name</span> <span class="required" data-i18n="required">*</span></label>
                            <input type="text" id="parentName" required data-i18n-placeholder="placeholder_full_name" placeholder="Full Name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="parentPhone"><span data-i18n="parent_phone">Parent Phone</span> <span class="required" data-i18n="required">*</span></label>
                            <input type="tel" id="parentPhone" required placeholder="+1234567890">
                        </div>
                        <div class="form-group">
                            <label for="parentEmail" data-i18n="parent_email">Parent Email</label>
                            <input type="email" id="parentEmail" placeholder="parent@example.com">
                        </div>
                        <div class="form-group">
                            <label for="fatherWork" data-i18n="father_work">Father's Work</label>
                            <input type="text" id="fatherWork" data-i18n-placeholder="placeholder_father_work" placeholder="e.g. Business, Teacher">
                        </div>
                    </div>
                </div>

                <!-- Section 4: Address -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-map-marker-alt"></i> <span data-i18n="address">Address</span></h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="district" data-i18n="district">District (‡¶ú‡ßá‡¶≤‡¶æ)</label>
                            <input type="text" id="district" data-i18n-placeholder="placeholder_district" placeholder="District">
                        </div>
                        <div class="form-group">
                            <label for="upazila" data-i18n="upazila">Upazila (‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ)</label>
                            <input type="text" id="upazila" data-i18n-placeholder="placeholder_upazila" placeholder="Upazila / Sub-district">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="address" data-i18n="detail_address">Detail Address</label>
                        <input type="text" id="address" data-i18n-placeholder="placeholder_address" placeholder="Village, Road, House no, etc.">
                    </div>
                </div>

                <!-- Section 5: Admission / Notes -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-calendar-check"></i> <span data-i18n="enrollment_details">Enrollment Details</span></h3>
                    <div class="form-group">
                        <label for="initialNotes" data-i18n="initial_notes_optional">Initial Notes (Optional)</label>
                        <textarea id="initialNotes" rows="3" data-i18n-placeholder="placeholder_notes" placeholder="Any relevant information about the student..."></textarea>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeAddStudentModal()">
                        <i class="fas fa-times"></i> <span data-i18n="btn_cancel">Cancel</span>
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> <span data-i18n="btn_add_student">Add Student</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Task Modal -->
    <div id="editTaskModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditTaskModal()">&times;</span>
            <h2><i class="fas fa-edit"></i> <span data-i18n="edit_task">Edit Task</span></h2>
            <form id="editTaskForm">
                <input type="hidden" id="editTaskId">
                
                <div class="form-group">
                    <label for="editTaskTitle" data-i18n="task_title">Task Title</label>
                    <input type="text" id="editTaskTitle" required data-i18n-placeholder="placeholder_task_title" placeholder="Enter task title">
                </div>

                <div class="form-group">
                    <label for="editTaskDescription" data-i18n="task_description">Description</label>
                    <textarea id="editTaskDescription" rows="4" data-i18n-placeholder="placeholder_task_description" placeholder="Enter task description"></textarea>
                </div>

                <div class="form-group">
                    <label for="editTaskType" data-i18n="task_type">Task Type</label>
                    <select id="editTaskType" required onchange="handleEditTaskTypeChange()">
                        <option value="one-time" data-i18n="task_type_onetime">One-time Task</option>
                        <option value="daily" data-i18n="task_type_daily">Daily Routine</option>
                    </select>
                    <small class="form-hint" id="editTaskTypeHint" style="display: none; color: #666; margin-top: 0.5rem;" data-i18n="task_type_hint">
                        Daily routines repeat every day and don't have deadlines
                    </small>
                </div>

                <div class="form-group" id="editStudentSelectionGroup">
                    <label data-i18n="assign_to">Assign To</label>
                    <div style="margin-bottom: 1rem;">
                        <label class="checkbox-item" style="background: #e3f2fd; padding: 0.75rem; border-radius: 8px;">
                            <input type="checkbox" id="editAssignToAll" onchange="handleEditAssignToAllChange()">
                            <span style="font-weight: 600; color: #1976D2;" data-i18n="assign_to_all">Assign to All Students</span>
                        </label>
                    </div>
                    <div id="editStudentCheckboxes" class="checkbox-group">
                        <!-- Checkboxes will be dynamically added here -->
                    </div>
                </div>

                <div class="form-group" id="editDeadlineGroup">
                    <label for="editTaskDeadline" data-i18n="deadline">Deadline</label>
                    <input type="date" id="editTaskDeadline">
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeEditTaskModal()">
                        <i class="fas fa-times"></i> <span data-i18n="btn_cancel">Cancel</span>
                    </button>
                <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> <span data-i18n="btn_update_task">Update Task</span>
                </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Firebase SDK - Auth + Firestore + Storage (for document download) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <!-- Storage Adapters (in separate folder) -->
    <script src="../js/storage/adapter.js"></script>
    <script src="../js/storage/localStorage.js"></script>
    <script src="../js/storage/firebase.js"></script>
    <script src="../js/storage/firebase-config.js"></script>
    <script src="../js/storage/config.js"></script>
    
    <!-- Auth & Data Manager -->
    <script src="../js/auth-config.js"></script>
    <script src="../js/data-manager.js"></script>
    <script src="../js/teacher-unread-badge.js"></script>
    <script src="../js/bottom-nav-scroll.js"></script>
    <script src="../js/teacher.js"></script>
</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Student Dashboard - Task Manager</title>
    <script src="../js/i18n.js"></script>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/student.css">
    <link rel="stylesheet" href="../css/messaging.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="student-dashboard-container">
        <!-- Compact Sidebar (hidden on mobile, shown on desktop) -->
        <div class="student-sidebar" id="studentSidebar">
            <div class="student-profile">
                <div class="student-profile-avatar" id="studentAvatar">A</div>
                <h2 id="studentNameSidebar">Student Name</h2>
                <p id="studentRole" data-i18n="student">Student</p>
            </div>

            <div class="sidebar-footer">
                <a href="/index.html" class="back-btn-sidebar" onclick="if(typeof logoutStudent==='function')logoutStudent();">
                    <i class="fas fa-sign-out-alt"></i>
                    <span data-i18n="logout">Logout</span>
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="student-main-content">
            <div class="student-header">
                <h1 id="studentNameHeader">Welcome, Student!</h1>
                <div class="student-header-actions" style="display: flex; align-items: center; gap: 0.75rem;">
                    <div class="lang-switcher lang-switcher-compact" aria-label="Language">
                        <button type="button" class="lang-btn" data-lang="en" onclick="setLang('en')" title="English">EN</button>
                        <button type="button" class="lang-btn" data-lang="bn" onclick="setLang('bn')" title="বাংলা">বাং</button>
                    </div>
                    <a href="/index.html" class="btn-secondary" onclick="if(typeof logoutStudent==='function')logoutStudent();">
                        <i class="fas fa-sign-out-alt"></i> <span data-i18n="logout">Logout</span>
                    </a>
                </div>
            </div>

            <!-- CSS-only Tabbed Interface -->
            <div class="tab-wrap-student">
                <!-- Tab Radio Inputs (hidden) -->
                <input type="radio" name="student-tab" id="tab-today" checked>
                <input type="radio" name="student-tab" id="tab-tasks">
                <input type="radio" name="student-tab" id="tab-exams">
                <input type="radio" name="student-tab" id="tab-messages">
                <input type="radio" name="student-tab" id="tab-records">
                <input type="radio" name="student-tab" id="tab-profile">

                <!-- Tab Labels (desktop - shown on larger screens) -->
                <div class="tab-labels-student tab-labels-desktop">
                    <label for="tab-today" class="student-tab-label">
                        <i class="fas fa-calendar-day"></i>
                        <span data-i18n="today">Today</span>
                    </label>
                    <label for="tab-tasks" class="student-tab-label">
                        <i class="fas fa-clipboard-list"></i>
                        <span data-i18n="tasks">Tasks</span>
                    </label>
                    <label for="tab-exams" class="student-tab-label">
                        <i class="fas fa-graduation-cap"></i>
                        <span data-i18n="nav_exams">Exams</span>
                    </label>
                    <label for="tab-messages" class="student-tab-label">
                        <i class="fas fa-comments"></i>
                        <span data-i18n="messages">Messages</span>
                        <span id="msgUnreadDot" class="tab-unread-dot" style="display: none;"></span>
                    </label>
                    <label for="tab-records" class="student-tab-label">
                        <i class="fas fa-history"></i>
                        <span data-i18n="tab_records">Records</span>
                    </label>
                    <label for="tab-profile" class="student-tab-label">
                        <i class="fas fa-user"></i>
                        <span data-i18n="profile">Profile</span>
                    </label>
                </div>

                <!-- Tab Panels -->
                <div class="panels-student">
                    <!-- TODAY TAB -->
                    <div class="panel-student panel-today">
                        <!-- Stat Cards (only on Today / Home) -->
                        <div class="stat-cards-row">
                            <div class="stat-card stat-card-daily">
                                <div class="stat-card-header">
                                    <i class="fas fa-calendar-day"></i>
                                    <span data-i18n="tab_daily">Daily Tasks</span>
                                </div>
                                <div class="stat-card-percentage" id="dailyPercentageCard">0%</div>
                                <div class="stat-card-progress">
                                    <div class="stat-card-progress-fill daily-fill" id="dailyProgressCard" style="width: 0%"></div>
                                </div>
                                <div class="stat-card-detail">
                                    <i class="fas fa-check"></i>
                                    <span><strong id="dailyCompletedCard">0</strong>/<span id="dailyTotalCard">0</span></span>
                                    <span class="stat-label" data-i18n="todays_completion">Today's completion</span>
                                </div>
                            </div>
                            <div class="stat-card stat-card-onetime">
                                <div class="stat-card-header">
                                    <i class="fas fa-tasks"></i>
                                    <span data-i18n="category_onetime">One-time Tasks</span>
                                </div>
                                <div class="stat-card-percentage" id="onetimePercentageCard">0%</div>
                                <div class="stat-card-progress">
                                    <div class="stat-card-progress-fill onetime-fill" id="onetimeProgressCard" style="width: 0%"></div>
                                </div>
                                <div class="stat-card-detail">
                                    <i class="fas fa-check-double"></i>
                                    <span><strong id="onetimeCompletedCard">0</strong>/<span id="onetimeTotalCard">0</span></span>
                                    <span class="stat-label" data-i18n="overall_completion">Overall completion</span>
                                </div>
                            </div>
                            <div class="stat-card stat-card-exam">
                                <div class="stat-card-header">
                                    <i class="fas fa-graduation-cap"></i>
                                    <span data-i18n="nav_exams">Exams</span>
                                </div>
                                <div class="stat-card-percentage" id="examPercentageCard">0%</div>
                                <div class="stat-card-progress">
                                    <div class="stat-card-progress-fill exam-fill" id="examProgressCard" style="width: 0%"></div>
                                </div>
                                <div class="stat-card-detail">
                                    <i class="fas fa-trophy"></i>
                                    <span><strong id="examPassedCard">0</strong>/<span id="examTotalCard">0</span></span>
                                    <span class="stat-label" data-i18n="passed_quizzes">Passed quizzes</span>
                                </div>
                            </div>
                        </div>

                        <!-- 30-Day Completion History -->
                        <div class="completion-history-section" id="completionHistorySection">
                            <div class="section-title comp-history-title">
                                <i class="fas fa-chart-line"></i>
                                <span data-i18n="last_30_days_completion">Last 30 Days</span>
                                <span class="comp-history-avg" id="compHistoryAvgPct"></span>
                            </div>
                            <div class="completion-history-scroll" id="completionHistoryScroll">
                                <!-- Filled by JS -->
                            </div>
                        </div>

                        <div class="tasks-section daily-tasks-section">
                            <div class="section-title">
                                <i class="fas fa-calendar-day"></i>
                                <span data-i18n="todays_daily_tasks">Today's Daily Tasks</span>
                                <span class="today-date" id="todayDate"></span>
                            </div>
                            <div id="dailyTasksList" class="tasks-list daily-tasks-list">
                                <!-- Daily tasks will be dynamically added here -->
                            </div>
                        </div>
                    </div>
                    <!-- END TODAY TAB -->

                    <!-- TASKS TAB -->
                    <div class="panel-student panel-tasks">
                        <!-- Pending Tasks Section -->
                        <div class="tasks-section" style="margin-bottom: 2rem;">
                            <div class="section-title">
                                <i class="fas fa-clipboard-list"></i>
                                <span data-i18n="pending_tasks">Pending Tasks</span>
                            </div>
                            <div id="pendingTasksList" class="tasks-list">
                                <!-- Pending tasks will be dynamically added here -->
                            </div>
                        </div>

                        <!-- Completed Tasks Section -->
                        <div class="tasks-section">
                            <div class="section-title">
                                <i class="fas fa-check-circle"></i>
                                <span data-i18n="completed_tasks">Completed Tasks</span>
                            </div>
                            <div id="completedTasksList" class="tasks-list">
                                <!-- Completed tasks will be dynamically added here -->
                            </div>
                        </div>
                    </div>
                    <!-- END TASKS TAB -->

                    <!-- EXAMS TAB -->
                    <div class="panel-student panel-exams">
                        <!-- Available Quizzes Section -->
                        <div class="tasks-section" style="margin-bottom: 2rem;">
                            <div class="section-title">
                                <i class="fas fa-clipboard-check"></i>
                                <span data-i18n="available_quizzes">Available Quizzes</span>
                            </div>
                            <div id="availableQuizzesList" class="quizzes-list-student">
                                <!-- Available quizzes will be dynamically added here -->
                            </div>
                        </div>

                        <!-- Completed Quizzes Section -->
                        <div class="tasks-section">
                            <div class="section-title">
                                <i class="fas fa-trophy"></i>
                                <span data-i18n="completed_quizzes">Completed Quizzes</span>
                            </div>
                            <div id="completedQuizzesList" class="quizzes-list-student">
                                <!-- Completed quizzes will be dynamically added here -->
                            </div>
                        </div>
                    </div>
                    <!-- END EXAMS TAB -->

                    <!-- MESSAGES TAB -->
                    <div class="panel-student panel-messages">
                        <div class="messages-tab-area" id="messagesTabArea">
                            <!-- Messages will be loaded by JS -->
                        </div>
                        <div class="messages-tab-input">
                            <input type="text" id="messageInputTab" placeholder="Type a message..." data-i18n-placeholder="type_message">
                            <button type="button" id="messageSendBtnTab">
                                <i class="fas fa-paper-plane"></i>
                                <span data-i18n="send">Send</span>
                            </button>
                        </div>
                    </div>
                    <!-- END MESSAGES TAB -->

                    <!-- RECORDS TAB -->
                    <div class="panel-student panel-records">
                        <div class="records-tab-area" id="recordsTabArea">
                            <!-- Records will be loaded by JS -->
                        </div>
                    </div>
                    <!-- END RECORDS TAB -->

                    <!-- PROFILE TAB -->
                    <div class="panel-student panel-profile">
                        <div class="student-profile-section">
                            <h3 class="profile-section-title">
                                <i class="fas fa-user-circle"></i> <span data-i18n="student_information">Student Information</span>
                            </h3>
                            <div class="profile-info-grid profile-info-student">
                                <div class="profile-info-card">
                                    <h4><i class="fas fa-id-card"></i> <span data-i18n="basic_details">Basic Details</span></h4>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="student_id">Student ID</span>
                                        <span class="profile-info-value" id="profileStudentId">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="date_of_birth">Date of Birth</span>
                                        <span class="profile-info-value" id="profileDateOfBirth">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="year">Year</span>
                                        <span class="profile-info-value" id="profileYear">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="admission_date">Admission Date</span>
                                        <span class="profile-info-value" id="profileAdmissionDate">-</span>
                                    </div>
                                </div>
                                <div class="profile-info-card">
                                    <h4><i class="fas fa-address-book"></i> <span data-i18n="contact_details">Contact Details</span></h4>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="phone">Phone</span>
                                        <span class="profile-info-value" id="profilePhone">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="email">Email</span>
                                        <span class="profile-info-value" id="profileEmail">-</span>
                                    </div>
                                </div>
                                <div class="profile-info-card">
                                    <h4><i class="fas fa-users"></i> <span data-i18n="parent_guardian_info">Parent/Guardian</span></h4>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="name">Name</span>
                                        <span class="profile-info-value" id="profileParentName">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="phone">Phone</span>
                                        <span class="profile-info-value" id="profileParentPhone">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="email">Email</span>
                                        <span class="profile-info-value" id="profileParentEmail">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="father_work">Father's Work</span>
                                        <span class="profile-info-value" id="profileFatherWork">-</span>
                                    </div>
                                </div>
                                <div class="profile-info-card">
                                    <h4><i class="fas fa-map-marker-alt"></i> <span data-i18n="address">Address</span></h4>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="district">District</span>
                                        <span class="profile-info-value" id="profileDistrict">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="upazila">Upazila</span>
                                        <span class="profile-info-value" id="profileUpazila">-</span>
                                    </div>
                                    <div class="profile-info-row">
                                        <span class="profile-info-label" data-i18n="detail_address">Detail Address</span>
                                        <span class="profile-info-value" id="profileAddress">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Change PIN Section -->
                        <div class="student-profile-section" style="margin-top: 1.5rem;">
                            <h3 class="profile-section-title">
                                <i class="fas fa-key"></i> <span data-i18n="change_pin">Change PIN</span>
                            </h3>
                            <form id="changePinForm" class="change-pin-form" onsubmit="handleChangePin(event)">
                                <div class="form-group">
                                    <label for="changePinCurrent"><span data-i18n="old_pin">Current PIN</span> <span class="required" data-i18n="required">*</span></label>
                                    <input type="password" id="changePinCurrent" required minlength="4" maxlength="8" data-i18n-placeholder="placeholder_pin" placeholder="Current PIN" autocomplete="current-password">
                                </div>
                                <div class="form-group">
                                    <label for="changePinNew"><span data-i18n="new_pin">New PIN</span> <span class="required" data-i18n="required">*</span></label>
                                    <input type="password" id="changePinNew" required minlength="4" maxlength="8" data-i18n-placeholder="placeholder_pin" placeholder="New PIN" autocomplete="new-password">
                                </div>
                                <div class="form-group">
                                    <label for="changePinConfirm"><span data-i18n="confirm_pin">Confirm PIN</span> <span class="required" data-i18n="required">*</span></label>
                                    <input type="password" id="changePinConfirm" required minlength="4" maxlength="8" data-i18n-placeholder="placeholder_pin" placeholder="Confirm PIN" autocomplete="new-password">
                                </div>
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-save"></i> <span data-i18n="change_pin">Change PIN</span>
                                </button>
                            </form>
                        </div>
                    </div>
                    <!-- END PROFILE TAB -->
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Bottom Navigation (like teacher - visible on screens ≤768px) -->
    <div class="student-bottom-nav-wrapper bottom-nav-wrapper">
        <div class="bottom-nav-fade bottom-nav-fade-left" id="studentNavFadeLeft" aria-hidden="true"><i class="fas fa-chevron-left"></i></div>
        <nav class="bottom-nav" id="studentBottomNav" aria-label="Student navigation">
            <label for="tab-today" class="bottom-nav-item active" data-tab="tab-today" id="studentNavToday">
                <i class="fas fa-calendar-day"></i>
                <span data-i18n="today">Today</span>
            </label>
            <label for="tab-tasks" class="bottom-nav-item" data-tab="tab-tasks">
                <i class="fas fa-clipboard-list"></i>
                <span data-i18n="tasks">Tasks</span>
            </label>
            <label for="tab-exams" class="bottom-nav-item" data-tab="tab-exams">
                <i class="fas fa-graduation-cap"></i>
                <span data-i18n="nav_exams">Exams</span>
            </label>
            <label for="tab-messages" class="bottom-nav-item" data-tab="tab-messages">
                <i class="fas fa-comments"></i>
                <span data-i18n="messages">Messages</span>
                <span id="msgUnreadDotNav" class="nav-unread-dot" style="display: none;"></span>
            </label>
            <label for="tab-records" class="bottom-nav-item" data-tab="tab-records">
                <i class="fas fa-history"></i>
                <span data-i18n="tab_records">Records</span>
            </label>
            <label for="tab-profile" class="bottom-nav-item" data-tab="tab-profile">
                <i class="fas fa-user"></i>
                <span data-i18n="profile">Profile</span>
            </label>
        </nav>
        <div class="bottom-nav-fade bottom-nav-fade-right" id="studentNavFadeRight" aria-hidden="true"><i class="fas fa-chevron-right"></i></div>
    </div>

    <!-- Modal: 30-Day Date Details -->
    <div class="day-details-overlay" id="dayDetailsOverlay" role="dialog" aria-modal="true" aria-labelledby="dayDetailsTitle" style="display: none;">
        <div class="day-details-modal">
            <div class="day-details-header">
                <h2 id="dayDetailsTitle">Date Details</h2>
                <button type="button" class="day-details-close" id="dayDetailsClose" aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="day-details-body">
                <div class="day-details-summary" id="dayDetailsSummary"></div>
                <ul class="day-details-tasks" id="dayDetailsTasks"></ul>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Storage Adapters -->
    <script src="../js/storage/adapter.js"></script>
    <script src="../js/storage/localStorage.js"></script>
    <script src="../js/storage/firebase.js"></script>
    <script src="../js/storage/firebase-config.js"></script>
    <script src="../js/storage/config.js"></script>
    
    <!-- Auth & Data Manager -->
    <script src="../js/auth-config.js"></script>
    <script src="../js/data-manager.js"></script>
    <script src="../js/student-dashboard.js"></script>
    <script src="../js/student-bottom-nav.js"></script>
</body>
</html>
